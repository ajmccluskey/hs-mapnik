before_install:
- sudo add-apt-repository ppa:mapnik/nightly-trunk -y
- sudo apt-get update -q
- sudo apt-get install libgmp-dev libmapnik-dev gcc-4.8 g++-4.8 -y
- mapnik-config --version
- g++ --version
- gcc --version
# Download, install and setup stack
- |
  echo "Installing Stack"
  set -e

  mkdir -p $HOME/.local/bin

  travis_retry curl -L https://www.stackage.org/stack/linux-x86_64 \
   | tar xz --wildcards --strip-components=1 -C $HOME/.local/bin '*/stack'

  stack --no-terminal setup

script:
  - stack test --flag hs-mapnik:examples --no-terminal --ghc-options="-pgmc g++-4.8"
  - stack exec hs-mapnik-demo
